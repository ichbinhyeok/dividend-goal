<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3533137832089555" crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-V3151LZWH6"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-V3151LZWH6');
    </script>

    <meta charset="UTF-8">
    <link rel="icon" href="https://fav.farm/üí∞" />
    <title th:text="${pageTitle}">How Much Do You Need to Earn $1,000 a Month? | Money First</title>
    <meta name="description" th:attr="content=${pageDescription}">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        :root {
            --primary-color: #0f172a;
            --accent-color: #10b981;
            --bg-color: #f1f5f9;
            --error-color: #ef4444;
        }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg-color); color: #334155; }
        .hero-section { background-color: #f8fafc; padding: 5rem 1rem; border-bottom: 1px solid #e2e8f0; text-align: center; }
        .card-glow { background: #ffffff; border: none; border-radius: 20px; box-shadow: 0 10px 40px -10px rgba(0,0,0,0.08); transition: transform 0.2s; }
        .form-control { border-radius: 12px; padding: 1rem; border: 1px solid #e2e8f0; font-size: 1.1rem; }
        .form-control:focus { border-color: var(--accent-color); box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.1); }
        .input-group-custom { position: relative; }
        .input-group-custom::after { content: '‚ñº'; position: absolute; right: 1.2rem; top: 50%; transform: translateY(-50%); font-size: 0.8rem; color: #94a3b8; pointer-events: none; }
        .is-invalid-ticker { border-color: var(--error-color) !important; box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1) !important; }
        .btn-primary { background-color: var(--primary-color); border: none; border-radius: 12px; font-weight: 600; padding: 1rem 2rem; transition: all 0.2s; }
        .btn-primary:hover { background-color: #1e293b; transform: translateY(-2px); }
        .ad-slot { background: transparent; border: 2px dashed #cbd5e1; border-radius: 12px; color: #94a3b8; padding: 20px; text-align: center; margin: 2rem 0; font-size: 0.9rem; }

        /* ÌîÑÎ¶¨ÏÖã Î≤ÑÌäº Ïä§ÌÉÄÏùºÎßÅ */
        .preset-btn { font-size: 0.7rem !important; padding: 0.2rem 0.5rem !important; border-radius: 6px !important; color: #64748b !important; border-color: #e2e8f0 !important; }
        .preset-btn:hover { background-color: #f8fafc !important; color: var(--primary-color) !important; }
    </style>
</head>
<body>

<nav class="navbar navbar-expand-lg py-3 bg-white border-bottom sticky-top">
    <div class="container">
        <a class="navbar-brand fw-bold fs-4" href="/" style="color: var(--primary-color);">üí∏ Money First</a>
    </div>
</nav>

<div class="hero-section">
    <div class="container">
        <h1 class="display-4 fw-bold mb-3" style="color: var(--primary-color); letter-spacing: -0.03em;">"I want <span style="color: var(--accent-color);">$1,000</span> per month."</h1>
        <p class="lead text-muted mb-4">Calculate exactly how much capital you need for financial freedom.</p>
    </div>
</div>

<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-lg-8 card-glow p-4 p-md-5">
            <div th:if="${error}" class="alert alert-danger border-0 rounded-4 mb-4" role="alert" th:text="${error}"></div>

            <form id="calcForm" action="/calculate" method="post" class="row g-4">
                <div class="col-md-6">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <label class="form-label fw-semibold mb-0">Monthly Goal</label>
                        <div class="d-flex gap-1">
                            <button type="button" class="btn btn-outline-secondary btn-sm preset-btn" data-amount="50">üçø $50</button>
                            <button type="button" class="btn btn-outline-secondary btn-sm preset-btn" data-amount="150">‚òï $150</button>
                            <button type="button" class="btn btn-outline-secondary btn-sm preset-btn" data-amount="500">üöó $500</button>
                        </div>
                    </div>
                    <div class="input-group">
                        <span class="input-group-text bg-light border-end-0 fw-bold text-muted">$</span>
                        <input class="form-control border-start-0 ps-0" type="number" id="amountInput" name="amount" value="1000" required>
                    </div>
                </div>

                <div class="col-md-6">
                    <label class="form-label fw-semibold mb-2">Dividend Ticker</label>
                    <div class="input-group-custom">
                        <input class="form-control pe-5" list="tickerOptions" id="tickerInput" name="ticker" placeholder="e.g. SCHD" required autocomplete="off">
                        <datalist id="tickerOptions">
                            <option th:each="stock : ${stocks}" th:value="${stock.ticker}" th:text="${stock.name}"></option>
                        </datalist>
                    </div>
                    <div id="tickerError" class="text-danger small mt-2 fw-medium" style="display: none;">‚ö†Ô∏è Ticker not found.</div>
                </div>

                <div class="col-12 d-grid">
                    <button class="btn btn-primary btn-lg" type="submit" id="submitBtn">Calculate Capital Required</button>
                </div>
            </form>

            <div class="ad-slot">AdSense Placeholder</div>

            <footer class="mt-5 pt-4 border-top text-center text-muted small">
                <div class="d-flex flex-wrap justify-content-center gap-4">
                    <a href="/" class="text-decoration-none text-muted fw-bold">Calculator</a>
                    <a href="/articles" class="text-decoration-none text-muted fw-bold">Articles</a>
                    <a href="/about" class="text-decoration-none text-muted">About</a>
                </div>
                <div class="mt-3">&copy; 2026 Money First. All rights reserved.</div>
            </footer>
        </div>
    </div>
</div>

<script th:inline="javascript">
    const allStocks = /*[[${stocks}]]*/ [];
    const tickerInput = document.getElementById('tickerInput');
    const tickerOptions = document.getElementById('tickerOptions');
    const submitBtn = document.getElementById('submitBtn');
    const amountInput = document.getElementById('amountInput');

    /* 1. Îí§Î°úÍ∞ÄÍ∏∞ Ïãú Ï¥àÍ∏∞Ìôî */
    window.onpageshow = function() {
        submitBtn.disabled = false;
        submitBtn.innerHTML = 'Calculate Capital Required';
    };

    /* 2. ÌîÑÎ¶¨ÏÖã Í∏∞Îä• */
    document.querySelectorAll('.preset-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            amountInput.value = btn.dataset.amount;
            amountInput.focus();
        });
    });

    /* 3. ÏãúÏûë Îã®Ïñ¥ Ïö∞ÏÑ† Í≤ÄÏÉâ Î°úÏßÅ */
    tickerInput.addEventListener('input', function() {
        const q = this.value.trim().toUpperCase();
        this.classList.remove('is-invalid-ticker');
        document.getElementById('tickerError').style.display = 'none';

        if (q.length < 1) return;

        const startsWith = [], contains = [];
        allStocks.forEach(s => {
            const t = s.ticker.toUpperCase();
            if (t.startsWith(q)) startsWith.push(s);
            else if (t.includes(q) || s.name.toUpperCase().includes(q)) contains.push(s);
        });

        const filtered = [...startsWith, ...contains].slice(0, 15);
        tickerOptions.innerHTML = '';
        filtered.forEach(s => {
            const opt = document.createElement('option');
            opt.value = s.ticker;
            opt.textContent = s.name;
            tickerOptions.appendChild(opt);
        });
    });

    /* 4. ÏµúÏ¢Ö Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨ */
    document.getElementById('calcForm').addEventListener('submit', function(e) {
        const val = tickerInput.value.trim().toUpperCase();
        const valid = allStocks.map(s => s.ticker.toUpperCase());
        if (!valid.includes(val)) {
            e.preventDefault();
            document.getElementById('tickerError').style.display = 'block';
            tickerInput.classList.add('is-invalid-ticker');
        } else {
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm"></span> Calculating...';
        }
    });
</script>
</body>
</html>